<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantumLab Pro</title>
    <style>
        :root {
            --primary-color: #0071e3;
            --secondary-color: #86868b;
            --background-color: #f5f5f7;
            --card-color: #ffffff;
            --text-color: #1d1d1f;
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .card {
            background-color: var(--card-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 30px;
        }
        
        h1, h2, h3 {
            margin-top: 0;
            font-weight: 600;
        }
        
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .btn:hover {
            background-color: #0062c3;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
        }
        
        .btn-secondary:hover {
            background-color: #6e6e73;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .result-section {
            margin-top: 30px;
        }
        
        .circuit-display {
            background-color: #f8f8f8;
            border-radius: 8px;
            padding: 15px;
            font-family: monospace;
            white-space: pre;
            overflow-x: auto;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .metric-card {
            background-color: var(--card-color);
            border-radius: var(--border-radius);
            padding: 15px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 28px;
            font-weight: 600;
            margin: 10px 0;
        }
        
        .metric-label {
            color: var(--secondary-color);
            font-size: 14px;
        }
        
        .visualization {
            height: 300px;
            background-color: #000;
            border-radius: 8px;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .qubit {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: var(--primary-color);
            transform: translate(-50%, -50%);
        }
        
        .connection {
            position: absolute;
            height: 2px;
            background-color: rgba(255, 255, 255, 0.3);
            transform-origin: left center;
        }
        
        .histogram {
            height: 200px;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            margin-top: 20px;
        }
        
        .bar {
            width: 40px;
            background-color: var(--primary-color);
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
            position: relative;
        }
        
        .bar-label {
            position: absolute;
            bottom: -25px;
            width: 100%;
            text-align: center;
            font-size: 12px;
        }
        
        .bar-value {
            position: absolute;
            top: -25px;
            width: 100%;
            text-align: center;
            font-size: 12px;
        }
        
        .tab-container {
            display: flex;
            border-bottom: 1px solid #d2d2d7;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
        }
        
        .tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .status {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .status.success {
            background-color: #d1e7dd;
            color: #0f5132;
            display: block;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #842029;
            display: block;
        }
        
        .status.warning {
            background-color: #fff3cd;
            color: #664d03;
            display: block;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 113, 227, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .metrics {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">QuantumLab Pro</div>
            <div>
                <button class="btn" id="runBtn">Run Simulation</button>
            </div>
        </header>
        
        <div class="grid">
            <div>
                <div class="card">
                    <h2>Quantum Circuit Configuration</h2>
                    
                    <div class="tab-container">
                        <div class="tab active" data-tab="editor">Circuit Editor</div>
                        <div class="tab" data-tab="properties">Qubit Properties</div>
                        <div class="tab" data-tab="noise">Noise Parameters</div>
                    </div>
                    
                    <div class="tab-content active" id="editor">
                        <div class="form-group">
                            <label for="circuitCode">Quantum Circuit (QASM)</label>
                            <textarea id="circuitCode" placeholder="Example: 
OPENQASM 2.0;
include &quot;qelib1.inc&quot;;
qreg q[2];
creg c[2];
h q[0];
cx q[0],q[1];
measure q[0] -&gt; c[0];
measure q[1] -&gt; c[1];">OPENQASM 2.0;
include "qelib1.inc";
qreg q[2];
creg c[2];
h q[0];
cx q[0],q[1];
measure q[0] -> c[0];
measure q[1] -> c[1];</textarea>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="properties">
                        <div class="form-group">
                            <label>Qubit 0 Properties</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <label for="q0-type">Type</label>
                                    <select id="q0-type">
                                        <option value="TRANSMON">Transmon</option>
                                        <option value="SPIN">Spin</option>
                                        <option value="TOPOLOGICAL">Topological</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="q0-t1">T1 (μs)</label>
                                    <input type="number" id="q0-t1" value="50.0" step="0.1">
                                </div>
                                <div>
                                    <label for="q0-t2">T2 (μs)</label>
                                    <input type="number" id="q0-t2" value="70.0" step="0.1">
                                </div>
                                <div>
                                    <label for="q0-gate-time">Gate Time (ns)</label>
                                    <input type="number" id="q0-gate-time" value="50.0" step="1">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Qubit 1 Properties</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <label for="q1-type">Type</label>
                                    <select id="q1-type">
                                        <option value="TRANSMON">Transmon</option>
                                        <option value="SPIN">Spin</option>
                                        <option value="TOPOLOGICAL">Topological</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="q1-t1">T1 (μs)</label>
                                    <input type="number" id="q1-t1" value="45.0" step="0.1">
                                </div>
                                <div>
                                    <label for="q1-t2">T2 (μs)</label>
                                    <input type="number" id="q1-t2" value="65.0" step="0.1">
                                </div>
                                <div>
                                    <label for="q1-gate-time">Gate Time (ns)</label>
                                    <input type="number" id="q1-gate-time" value="55.0" step="1">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="noise">
                        <div class="form-group">
                            <label for="snr">Signal-to-Noise Ratio (SNR)</label>
                            <input type="range" id="snr" min="0.1" max="100" step="0.1" value="30">
                            <div style="display: flex; justify-content: space-between;">
                                <span>0.1</span>
                                <span id="snrValue">30.0</span>
                                <span>100</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="shots">Number of Shots</label>
                            <input type="number" id="shots" min="1" max="1000000" value="1024">
                        </div>
                        
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="advancedNoise" checked>
                                Enable Advanced Noise Model
                            </label>
                        </div>
                        
                        <div class="form-group" id="advancedNoiseOptions">
                            <label>
                                <input type="checkbox" id="enableCrosstalk" checked>
                                Enable Crosstalk
                            </label>
                            <label>
                                <input type="checkbox" id="enableNonMarkovian" checked>
                                Enable Non-Markovian Effects
                            </label>
                            <label>
                                <input type="checkbox" id="enableML" checked>
                                Enable Machine Learning Correction
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h2>Circuit Visualization</h2>
                    <div class="circuit-display" id="circuitDisplay">
                        No circuit loaded
                    </div>
                </div>
            </div>
            
            <div>
                <div class="card">
                    <h2>Simulation Results</h2>
                    <div id="statusMessage" class="status"></div>
                    
                    <div class="metrics">
                        <div class="metric-card">
                            <div class="metric-label">Fidelity</div>
                            <div class="metric-value" id="fidelity">-</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Execution Time</div>
                            <div class="metric-value" id="execTime">-</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Qubits</div>
                            <div class="metric-value" id="qubitCount">-</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 20px;">Measurement Results</h3>
                    <div class="histogram" id="histogram">
                        <div class="bar" style="height: 0%;">
                            <div class="bar-value">0%</div>
                            <div class="bar-label">00</div>
                        </div>
                        <div class="bar" style="height: 0%;">
                            <div class="bar-value">0%</div>
                            <div class="bar-label">01</div>
                        </div>
                        <div class="bar" style="height: 0%;">
                            <div class="bar-value">0%</div>
                            <div class="bar-label">10</div>
                        </div>
                        <div class="bar" style="height: 0%;">
                            <div class="bar-value">0%</div>
                            <div class="bar-label">11</div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 20px;">Quantum State Visualization</h3>
                    <div class="visualization" id="quantumViz">
                        <div class="qubit" style="top: 50%; left: 30%;"></div>
                        <div class="qubit" style="top: 50%; left: 70%;"></div>
                        <div class="connection" style="width: 40%; top: 50%; left: 30%;"></div>
                    </div>
                </div>
                
                <div class="card">
                    <h2>Noise Analysis</h2>
                    <div id="noiseAnalysis">
                        <p>Run simulation to see noise analysis data.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });
        
        // SNR slider
        const snrSlider = document.getElementById('snr');
        const snrValue = document.getElementById('snrValue');
        snrSlider.addEventListener('input', () => {
            snrValue.textContent = snrSlider.value;
        });
        
        // Advanced noise options toggle
        const advancedNoiseCheckbox = document.getElementById('advancedNoise');
        const advancedNoiseOptions = document.getElementById('advancedNoiseOptions');
        
        advancedNoiseCheckbox.addEventListener('change', () => {
            advancedNoiseOptions.style.display = advancedNoiseCheckbox.checked ? 'block' : 'none';
        });
        
        // Run simulation
        const runBtn = document.getElementById('runBtn');
        const statusMessage = document.getElementById('statusMessage');
        
        runBtn.addEventListener('click', async () => {
            // Show loading state
            runBtn.disabled = true;
            runBtn.innerHTML = '<span class="loading"></span> Running...';
            statusMessage.className = 'status';
            statusMessage.textContent = '';
            
            try {
                // Get input values
                const circuitCode = document.getElementById('circuitCode').value;
                const shots = parseInt(document.getElementById('shots').value);
                const snr = parseFloat(document.getElementById('snr').value);
                const advancedNoise = document.getElementById('advancedNoise').checked;
                
                // Qubit properties
                const qubitProps = {
                    0: {
                        qubit_type: document.getElementById('q0-type').value,
                        t1: parseFloat(document.getElementById('q0-t1').value),
                        t2: parseFloat(document.getElementById('q0-t2').value),
                        gate_times: {
                            'h': parseFloat(document.getElementById('q0-gate-time').value),
                            'cx': parseFloat(document.getElementById('q0-gate-time').value) * 4
                        }
                    },
                    1: {
                        qubit_type: document.getElementById('q1-type').value,
                        t1: parseFloat(document.getElementById('q1-t1').value),
                        t2: parseFloat(document.getElementById('q1-t2').value),
                        gate_times: {
                            'h': parseFloat(document.getElementById('q1-gate-time').value),
                            'cx': parseFloat(document.getElementById('q1-gate-time').value) * 4
                        }
                    }
                };

                // Update circuit display
                document.getElementById('circuitDisplay').textContent = circuitCode;

                // Simulate API call (in a real app, this would call your Python backend)
                await new Promise(resolve => setTimeout(resolve, 1500));

                // Generate random results for demo purposes
                const results = generateRandomResults(circuitCode, shots, snr, advancedNoise);

                // Display results
                updateResultsDisplay(results);

                // Show success message
                statusMessage.className = 'status success';
                statusMessage.textContent = 'Simulation completed successfully!';
            } catch (error) {
                // Show error message
                statusMessage.className = 'status error';
                statusMessage.textContent = `Error: ${error.message}`;
            } finally {
                // Reset button
                runBtn.disabled = false;
                runBtn.textContent = 'Run Simulation';
            }
        });

        // Helper function to generate demo results
        function generateRandomResults(circuitCode, shots, snr, advancedNoise) {
            const hasEntanglement = circuitCode.includes('cx') || circuitCode.includes('cz');
            const baseErrorRate = Math.max(0.05, 0.15 - (snr / 200));
            
            // Generate counts
            const counts = {};
            const states = ['00', '01', '10', '11'];
            
            if (hasEntanglement) {
                // For entangled states, most results should be 00 or 11
                counts['00'] = Math.floor(shots * (0.45 + (0.4 * (1 - baseErrorRate))));
                counts['11'] = Math.floor(shots * (0.45 + (0.4 * (1 - baseErrorRate))));
                counts['01'] = Math.floor(shots * (0.05 * baseErrorRate));
                counts['10'] = Math.floor(shots * (0.05 * baseErrorRate));
            } else {
                // For non-entangled states, more uniform distribution
                counts['00'] = Math.floor(shots * 0.25);
                counts['01'] = Math.floor(shots * 0.25);
                counts['10'] = Math.floor(shots * 0.25);
                counts['11'] = Math.floor(shots * 0.25);
            }
            
            // Adjust for advanced noise
            if (advancedNoise) {
                const noiseFactor = 1 + (0.5 - (snr / 200));
                counts['00'] = Math.floor(counts['00'] * (1 - (0.1 * noiseFactor)));
                counts['11'] = Math.floor(counts['11'] * (1 - (0.1 * noiseFactor)));
                counts['01'] = Math.floor(counts['01'] * (1 + (0.2 * noiseFactor)));
                counts['10'] = Math.floor(counts['10'] * (1 + (0.2 * noiseFactor)));
            }
            
            // Normalize to ensure total equals shots
            const total = Object.values(counts).reduce((sum, count) => sum + count, 0);
            const diff = shots - total;
            if (diff !== 0) {
                counts['00'] += diff;
            }
            
            // Calculate metrics
            const fidelity = Math.max(0, 0.95 - baseErrorRate - (advancedNoise ? 0.05 : 0));
            const execTime = 50 + (shots / 100) + (circuitCode.length / 10);
            const qubitCount = (circuitCode.match(/qreg q\[(\d+)\]/) || [,'2'])[1];
            
            return {
                counts,
                fidelity,
                execTime,
                qubitCount,
                noiseAnalysis: {
                    t1Error: baseErrorRate * 0.3,
                    t2Error: baseErrorRate * 0.4,
                    gateError: baseErrorRate * 0.2,
                    readoutError: baseErrorRate * 0.1,
                    crosstalk: advancedNoise ? baseErrorRate * 0.15 : 0
                }
            };
        }

        // Update the UI with results
        function updateResultsDisplay(results) {
            // Update metrics
            document.getElementById('fidelity').textContent = results.fidelity.toFixed(3);
            document.getElementById('execTime').textContent = `${results.execTime.toFixed(1)} ms`;
            document.getElementById('qubitCount').textContent = results.qubitCount;
            
            // Update histogram
            const totalShots = Object.values(results.counts).reduce((sum, count) => sum + count, 0);
            const histogram = document.getElementById('histogram');
            histogram.innerHTML = '';
            
            Object.entries(results.counts).forEach(([state, count]) => {
                const percentage = (count / totalShots) * 100;
                const bar = document.createElement('div');
                bar.className = 'bar';
                bar.style.height = `${percentage}%`;
                bar.innerHTML = `
                    <div class="bar-value">${percentage.toFixed(1)}%</div>
                    <div class="bar-label">${state}</div>
                `;
                histogram.appendChild(bar);
            });
            
            // Update noise analysis
            const noiseAnalysis = document.getElementById('noiseAnalysis');
            noiseAnalysis.innerHTML = `
                <h3>Error Breakdown</h3>
                <p>T1 Relaxation Error: ${(results.noiseAnalysis.t1Error * 100).toFixed(2)}%</p>
                <p>T2 Dephasing Error: ${(results.noiseAnalysis.t2Error * 100).toFixed(2)}%</p>
                <p>Gate Error: ${(results.noiseAnalysis.gateError * 100).toFixed(2)}%</p>
                <p>Readout Error: ${(results.noiseAnalysis.readoutError * 100).toFixed(2)}%</p>
                ${results.noiseAnalysis.crosstalk > 0 ? 
                    `<p>Crosstalk Error: ${(results.noiseAnalysis.crosstalk * 100).toFixed(2)}%</p>` : ''}
            `;
            
            // Update quantum visualization
            updateQuantumVisualization(results.qubitCount, results.counts);
        }

        // Update quantum visualization
        function updateQuantumVisualization(qubitCount, counts) {
            const viz = document.getElementById('quantumViz');
            viz.innerHTML = '';
            
            // Calculate positions for qubits
            const positions = [];
            for (let i = 0; i < qubitCount; i++) {
                const x = 30 + (i * (40 / Math.max(1, qubitCount - 1)) * 10;
                positions.push({ x, y: 50 });
                
                const qubit = document.createElement('div');
                qubit.className = 'qubit';
                qubit.style.top = `${50}%`;
                qubit.style.left = `${x}%`;
                viz.appendChild(qubit);
            }
            
            // Add connections based on entanglement
            if (qubitCount > 1) {
                const maxCount = Math.max(...Object.values(counts));
                const entangledStates = Object.entries(counts)
                    .filter(([state, count]) => count > maxCount * 0.7 && /1/.test(state))
                    .map(([state]) => state);
                
                if (entangledStates.length > 0) {
                    for (let i = 0; i < qubitCount - 1; i++) {
                        const connection = document.createElement('div');
                        connection.className = 'connection';
                        connection.style.width = `${positions[i+1].x - positions[i].x}%`;
                        connection.style.top = `${50}%`;
                        connection.style.left = `${positions[i].x}%`;
                        
                        // Highlight if these qubits are entangled in any state
                        const isEntangled = entangledStates.some(state => 
                            state[i] === '1' && state[i+1] === '1');
                        
                        if (isEntangled) {
                            connection.style.backgroundColor = 'rgba(0, 113, 227, 0.7)';
                            connection.style.height = '3px';
                        }
                        
                        viz.appendChild(connection);
                    }
                }
            }
        }

        // Initialize with default values
        updateQuantumVisualization(2, { '00': 0, '01': 0, '10': 0, '11': 0 });
    </script>
</body>
</html>
